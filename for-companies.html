const form = document.getElementById("companyForm");
const msg = document.getElementById("responseMsg");

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const formData = new FormData(form);
  const data = {};
  formData.forEach((value, key) => data[key] = value);

  // Show loading state
  const submitBtn = form.querySelector('button[type="submit"]');
  const originalText = submitBtn.textContent;
  submitBtn.textContent = 'Submitting...';
  submitBtn.disabled = true;

  try {
    const response = await fetch("https://script.google.com/macros/s/AKfycbz79WNQu_29saIRNP9P3gUcPObXCGiRxEQY_hMwmOyFR6DZZgTRqW5aCeG80Byq6OgH7Q/exec", {
      method: "POST",
      mode: 'cors',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data)
    });

    const result = await response.json();
    console.log("Response:", result);

    if (result.status === "success") {
      msg.textContent = "Form submitted successfully!";
      msg.classList.remove("hidden");
      msg.classList.add("text-green-600");
      form.reset();
    } else {
      throw new Error(result.message || "Submission failed");
    }

  } catch (error) {
    console.error("Submission error:", error);
    msg.textContent = "Error: " + error.message;
    msg.classList.remove("hidden", "text-green-600");
    msg.classList.add("text-red-600");
  } finally {
    // Reset button
    submitBtn.textContent = originalText;
    submitBtn.disabled = false;
  }
});
